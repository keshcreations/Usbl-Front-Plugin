// FrontJS v0.0.10
(function(t){function e(t,e,n){throw new Error("[Front] expected "+t+" to be "+e+" (got "+n+").")}function n(){}function o(){this.started=!1,this.seq=0,this.pendingCb={},this.customTargetWindow=null,this.qs=i(),this.domain=this.qs.front_domain||"https://app.frontapp.com",this.visible=!1,this.debug=t.enableFrontDebugMode,this.endpoint=location.href.replace(/[?&]auth_secret=.*$/,"")}function i(){for(var t=window.location.search.substring(1),e=t.split("&"),n={},o=0;o<e.length;o++){var i=e[o].split("=");2===i.length&&(n[decodeURIComponent(i[0])]=decodeURIComponent(i[1]))}return n}function r(t){return t?s(t):null}function s(t){return c.testString(t)?t:(c.isObject(t),c.isString(t.alias),t.alias)}function p(t){if(t.html)return t.html;if(t.body)return t.body;if(t.text){var e=document.createElement("div");return e.innerText=t.text,e.innerHTML}return""}!function(t,e,n){"function"==typeof define&&define.amd?define(n):"object"==typeof exports?module.exports=n():e[t]=n()}("heir",this,function(){"use strict";var t={inherit:function(e,n,o){var i=e.prototype=t.createObject(n.prototype);i.constructor=e,(o||"undefined"==typeof o)&&(e._super=n.prototype)},createObject:Object.create||function(t){var e=function(){};return e.prototype=t,new e},mixin:function(e,n){return t.merge(e.prototype,n)},merge:function(e,n){var o;for(o in n)t.hasOwn(n,o)&&(e[o]=n[o])},hasOwn:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}};return t}),function(){"use strict";function t(){}function e(t,e){for(var n=t.length;n--;)if(t[n].listener===e)return n;return-1}function n(t){return function(){return this[t].apply(this,arguments)}}var o=t.prototype,i=this,r=i.EventEmitter;o.getListeners=function(t){var e,n,o=this._getEvents();if(t instanceof RegExp){e={};for(n in o)o.hasOwnProperty(n)&&t.test(n)&&(e[n]=o[n])}else e=o[t]||(o[t]=[]);return e},o.flattenListeners=function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push(t[e].listener);return n},o.getListenersAsObject=function(t){var e,n=this.getListeners(t);return n instanceof Array&&(e={},e[t]=n),e||n},o.addListener=function(t,n){var o,i=this.getListenersAsObject(t),r="object"==typeof n;for(o in i)i.hasOwnProperty(o)&&e(i[o],n)===-1&&i[o].push(r?n:{listener:n,once:!1});return this},o.on=n("addListener"),o.addOnceListener=function(t,e){return this.addListener(t,{listener:e,once:!0})},o.once=n("addOnceListener"),o.defineEvent=function(t){return this.getListeners(t),this},o.defineEvents=function(t){for(var e=0;e<t.length;e+=1)this.defineEvent(t[e]);return this},o.removeListener=function(t,n){var o,i,r=this.getListenersAsObject(t);for(i in r)r.hasOwnProperty(i)&&(o=e(r[i],n),o!==-1&&r[i].splice(o,1));return this},o.off=n("removeListener"),o.addListeners=function(t,e){return this.manipulateListeners(!1,t,e)},o.removeListeners=function(t,e){return this.manipulateListeners(!0,t,e)},o.manipulateListeners=function(t,e,n){var o,i,r=t?this.removeListener:this.addListener,s=t?this.removeListeners:this.addListeners;if("object"!=typeof e||e instanceof RegExp)for(o=n.length;o--;)r.call(this,e,n[o]);else for(o in e)e.hasOwnProperty(o)&&(i=e[o])&&("function"==typeof i?r.call(this,o,i):s.call(this,o,i));return this},o.removeEvent=function(t){var e,n=typeof t,o=this._getEvents();if("string"===n)delete o[t];else if(t instanceof RegExp)for(e in o)o.hasOwnProperty(e)&&t.test(e)&&delete o[e];else delete this._events;return this},o.removeAllListeners=n("removeEvent"),o.emitEvent=function(t,e){var n,o,i,r,s,p=this.getListenersAsObject(t);for(r in p)if(p.hasOwnProperty(r))for(n=p[r].slice(0),i=n.length;i--;)o=n[i],o.once===!0&&this.removeListener(t,o.listener),s=o.listener.apply(this,e||[]),s===this._getOnceReturnValue()&&this.removeListener(t,o.listener);return this},o.trigger=n("emitEvent"),o.emit=function(t){var e=Array.prototype.slice.call(arguments,1);return this.emitEvent(t,e)},o.setOnceReturnValue=function(t){return this._onceReturnValue=t,this},o._getOnceReturnValue=function(){return!this.hasOwnProperty("_onceReturnValue")||this._onceReturnValue},o._getEvents=function(){return this._events||(this._events={})},t.noConflict=function(){return i.EventEmitter=r,t},"function"==typeof define&&define.amd?define(function(){return t}):"object"==typeof module&&module.exports?module.exports=t:i.EventEmitter=t}.call(this);var c={};["Arguments","Function","String","Number","Array","Date","RegExp","Boolean"].forEach(function(t){function n(e){return Object.prototype.toString.call(e)==="[object "+t+"]"}c["opt"+t]=function(t){return n(t)?t:null},c["is"+t]=function(o,i){n(o)||e(i,t,o)},c["test"+t]=function(t){return n(t)}}),c.isObject=function(t,n){var o=typeof t;"function"===o||"object"===o&&t||e(n,"Object",t)},this.heir.inherit(o,this.EventEmitter),o.prototype.init=function(t){t&&(this.customTargetWindow=document.querySelector(t).contentWindow)},o.prototype._validateDomain=function(){return t.allowAnyFrontDomain||/^https:\/\/[\w\-]+\.frontapp.com$/.test(this.domain)},o.prototype._connected=function(){this.emit(this.started?"reconnect":"ready"),this.started=!0},o.prototype._dispatch=function(t){var e=this.pendingCb[t.seq];delete this.pendingCb[t.seq],e&&"function"==typeof e&&e(t.val)},o.prototype._postCb=function(t,e){c.isFunction(e,"cb");var n=++this.seq;t.seq=n,this.pendingCb[n]=e,this.post(t)},o.prototype.post=function(e){var n=this.customTargetWindow||t.parent;n.postMessage(e,this.domain)},o.prototype.dialog=function(t,e,n){c.isObject(e,"options"),c.isString(e.title,"options.title"),c.isString(e.message,"options.message"),e.type=t,e.okTitle=c.optString(e.okTitle),e.cancelTitle=c.optString(e.cancelTitle),e.val=c.optString(e.val),this._postCb(e,n)},["alert","confirm","prompt","report"].forEach(function(t){o.prototype[t]=function(e,n){this.dialog(t,e,n)}}),o.prototype.promptDate=function(t,e){c.isObject(t,"options"),c.isObject(t.position,"options.position"),c.isNumber(t.position.left,"options.position.left"),c.isNumber(t.position.top,"options.position.top"),t.type="prompt_date",["val","before","after"].forEach(function(e){t[e]&&(c.isDate(t[e],"options."+e),t[e]=t[e].getTime())}),this._postCb(t,function(t){e(t&&new Date(t))})},o.prototype.fuzzylist=function(t,e){c.isObject(t,"options"),c.isArray(t.items,"options.items"),t.items.forEach(function(t){c.isString(t.title),c.optString(t.completion)}),t.type="fuzzylist",this._postCb(t,e)},o.prototype.copyToClipboard=function(t){this.post({type:"copy_clipboard",payload:t})},o.prototype.openUrl=function(t){this.post({type:"open_url",url:t})},o.prototype.openPopupUrl=function(t,e){this.post({type:"open_popup_url",url:t,title:e})},o.prototype.openPopup=function(e,n){var o=this;this._postCb({type:"will_open_popup"},function(){o._lastPopup=t.open(e,n,"menubar=no,title,resize,location=no,width=650,height=530")})},o.prototype.closePopup=function(){this._lastPopup&&(this._lastPopup.close(),this._lastPopup=null)},o.prototype.search=function(t){this.post({type:"search",query:t})},t.Front=new o,t.Front._validateDomain()||(t.Front.log("error","[Front] could not validate host domain "+t.Front.domain),t.Front=null);var a=["conversation","no_conversation","panel_visible"];t.addEventListener("message",function(e){if(e.origin!==t.Front.domain)return void t.Front.log("error","Received event from unexpected origin "+e.origin);var n=e.data,o=n.type;switch(a.indexOf(o)>=0&&t.Front.log("info","Received "+o+" event."),o){case"sync":t.Front._connected();break;case"user":t.Front.user=n.user;break;case"conversation":t.Front.emit("conversation",n);break;case"no_conversation":t.Front.emit("no_conversation");break;case"panel_visible":t.Front.visible=n.visible,t.Front.emit("panel_visible",n.visible);break;case"done":t.Front._dispatch(n)}}),t.addEventListener("click",function(e){function n(t,e){return t&&20!==e?"A"===t.tagName&&t.href?t:n(t.parentElement,e+1):null}if(0===e.button&&t.parent!==t){var o=n(e.target,0);if(o){if("_blank"!==o.target)return;e.preventDefault(),e.stopPropagation(),t.Front.openUrl(o.href)}}}),setTimeout(function(){t.Front&&(t.Front.post({type:"plugin_connected",endpoint:t.Front.endpoint,debug:t.Front.debug}),t.Front.log("info","Connecting..."))},0),o.prototype.fetchConversation=function(t){this._postCb({type:"fetch_conversation"},t)},o.prototype.fetchTeam=function(t){this._postCb({type:"fetch_team"},t)},o.prototype.fetchAllowedTeammates=function(t){this._postCb({type:"fetch_allowed_teammates"},t)},o.prototype.fetchInboxes=function(t){this._postCb({type:"fetch_inboxes"},t)},o.prototype.fetchChannels=function(t){this._postCb({type:"fetch_channels"},t)},o.prototype.fetchAllowedTags=function(t){this._postCb({type:"fetch_tags"},t)},o.prototype.fetchNotes=function(t){this._postCb({type:"fetch_notes"},t)},o.prototype.fetchDraft=function(t){this._postCb({type:"fetch_draft"},t)},o.prototype.fetchAppPath=function(t){this._postCb({type:"fetch_app_path"},t)},o.prototype.unassign=function(t){this.post({type:"unassign",conversation_id:t?t.id:null})},o.prototype.assign=function(t,e){var n=s(t);this.post({type:"assign",assignee:n,conversation_id:e?e.id:null})},o.prototype.attachTag=function(t,e){var n=s(t);this.post({type:"tag",tag:n,conversation_id:e?e.id:null})},o.prototype.detachTag=function(t,e){var n=s(t);this.post({type:"untag",tag:n,conversation_id:e?e.id:null})},o.prototype.toggleTag=function(t,e){var n=s(t);this.post({type:"toggle_tag",tag:n,conversation_id:e?e.id:null})},o.prototype.toggleArchive=function(t){this.post({type:"toggle_archived",conversation_id:t?t.id:null})},o.prototype.toggleTrashed=function(t){this.post({type:"toggle_trashed",conversation_id:t?t.id:null})},o.prototype.moveToInbox=function(t){var e=s(t);this.post({type:"move_to_inbox",inbox:e,inbox_alias:e})},o.prototype.addTopic=function(t,e){c.isObject(t),c.optString(t.type),c.optString(t.name),c.isString(t.ext_link),this._postCb({type:"add_topic",topic:t},e)},o.prototype.reply=function(t,e,o,i){t=t||{},i||"function"!=typeof o||(i=o),i=i||n,c.isObject(t),c.optString(t.body),c.optString(t.html),c.optString(t.text),c.optString(t.subject),c.optBoolean(t.send_now),c.optBoolean(t.mark_archived),c.optArray(t.to),c.optArray(t.cc),c.optArray(t.bcc),c.optArray(t.attachment_uids);var r=[];t.tags&&(c.isArray(t.tags),t.tags.forEach(function(t){r.push(s(t))})),this._postCb({type:e?"reply_all":"reply",tags:r,body:p(t),subject:t.subject||null,send_now:t.send_now||!1,mark_archived:t.mark_archived||null,to:t.to||null,cc:t.cc||null,bcc:t.bcc||null,conversation_id:o?o.id:null,attachment_uids:t.attachment_uids||null},i)},o.prototype.forwardTo=function(t,e){e=e||{},c.optString(t),c.optString(e.body),c.optString(e.subject),this.post({type:"forward",body:p(e),subject:e.subject||null,send_now:e.send_now||!1,mark_archived:e.mark_archived||null,to:t})},o.prototype.forward=function(t,e){t=t||{},e=e||n,c.optArray(t.to),c.optArray(t.cc),c.optArray(t.bcc),c.optString(t.body),c.optString(t.subject),c.optArray(t.attachment_uids),this._postCb({type:"forward",body:p(t),subject:t.subject||null,send_now:t.send_now||!1,mark_archived:t.mark_archived||null,to:t.to||null,cc:t.cc||null,bcc:t.bcc||null,attachment_uids:t.attachment_uids||null},e)},o.prototype.compose=function(t,e){t=t||{},e=e||n,c.isObject(t),c.optArray(t.to),c.optArray(t.cc),c.optArray(t.bcc),c.optString(t.from),c.optString(t.subject),c.optString(t.body),c.optBoolean(t.send_now),c.optBoolean(t.hide_composer),c.optBoolean(t.mark_archived),c.optArray(t.attachment_uids);var o=r(t.inbox),i=[];t.tags&&(c.isArray(t.tags),t.tags.forEach(function(t){i.push(s(t))})),this._postCb({type:"compose",from:t.from||null,to:t.to||null,cc:t.cc||null,bcc:t.bcc||null,body:p(t),subject:t.subject||null,send_now:t.send_now||!1,hide_composer:t.hide_composer,mark_archived:t.mark_archived||null,specifiedInboxAlias:o,tags:i,attachment_uids:t.attachment_uids||null},e)},o.prototype.insertHTML=function(t){c.isString(t),this.post({type:"insert_html",html:t})},o.prototype.updateDraft=function(t,e,o){e=e||{},o=o||n,c.isString(t),c.isObject(e),e.recipients&&(c.optArray(e.recipients.to),c.optArray(e.recipients.cc),c.optArray(e.recipients.bcc)),c.optArray(e.attachment_uids),this._postCb({type:"update_draft",draft_id:t,recipients:e.recipients||null,attachment_uids:e.attachment_uids||null},o)},o.prototype.setPanelWidth=function(t){c.isNumber(t),this.post({type:"set_width",width:t})};var u=["log","info","error","warn"];o.prototype.log=function(e,n){!this.debug||u.indexOf(e)<0||!t.console||t.console[e]("[Front] Plugin ("+this.endpoint+"): ",n)}}).call({},window);
//# sourceMappingURL=frontjs.min.js.map
